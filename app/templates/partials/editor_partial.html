<div class="editor-integrated">
    <!--<strong>Puzzle Editor</strong><br><br>-->

    <!-- Store puzzle metadata in data attributes for JavaScript -->
    <div data-puzzle-name="{{ puzzle.name if puzzle else '' }}"
         data-puzzle-game-mode="{{ puzzle.game_mode if puzzle else '' }}"
         data-puzzle-coins="{{ puzzle.coins or '' if puzzle else '' }}"
         data-puzzle-description="{{ puzzle.description or '' if puzzle else '' }}"
         style="display: none;"></div>


    <!-- Toolbar -->
    <div id="toolbar">
        <button id="add-node-btn">Add Node</button>
        <button id="add-edge-btn">Add Edge</button>

        <select id="faction-select">
            <option value="enemy">Enemy</option>
            <option value="player">Player</option>
        </select>
        <button id="place-unit-btn">Place Unit</button>
        <button id="edit-path-btn">Edit Paths</button>

        <select id="unit-type-select"></select>

        <button id="export-btn" type="button">
            {% if puzzle %}Update Puzzle{% else %}Create Puzzle{% endif %}
        </button>
    </div>

    <!-- playback controlls -->
    <div class="playback-controls"
         style="display: inline-block; margin-top: 0px; border-left: 0px solid #ccc; padding-left: 0px;">
        <button id="prev-turn-btn" type="button">◀ Back</button>
        <span id="turn-status" style="margin: 0 10px; font-weight: bold;">Turn: 0</span>
        <button id="next-turn-btn" type="button">Forward ▶</button>
    </div>

    <!-- Editor Canvas -->
    <div id="editor-container">
        <svg id="editor-svg"
             data-puzzle-id="{{ puzzle.id if puzzle else ''}}"
             data-puzzle-name="{{ puzzle.name if puzzle else ''}}"
             data-puzzle-game-mode="{{ puzzle.game_mode if puzzle else ''}}"
             data-puzzle-coins="{{ puzzle.coins or 0 if puzzle else ''}}"
             data-puzzle-description="{{ puzzle.description or '' if puzzle else ''}}"
             style="width: 100%; height: 500px; border: 1px solid #ccc;"></svg>
    </div>
    <br>

    <div>
        <form id="editor-form" method="POST" action="/puzzles">
            <label for="name">Puzzle Title:</label>
            <input type="text" name="name" id="name" placeholder="Puzzle Name"
                   value="{{ puzzle.name if puzzle else ''}}" required>
            <label for="game_mode">Game Mode:</label>
            <select name="game_mode" id="game_mode" required>
                <option value="">-- Game Mode --</option>
                <option value="Skirmish" {% if puzzle.game_mode==
                'Skirmish' %}selected{% endif %}>Skirmish</option>
                <option value="Safe travel" {% if puzzle.game_mode==
                'Safe travel' %}selected{% endif %}>Safe travel</option>
            </select>

            <label for="coins">Coins:</label>
            <input type="number" name="coins" id="coins" placeholder="Coins"
                   value="{{ puzzle.coins or '' if puzzle else '' }}">
            <label for="is_working">Is the puzzle working?</label>
            <select name="is_working" id="is_working">
                <option value="False" {% if puzzle.is_working== False %}selected{% endif %}>No</option>
                <option value="True" {% if puzzle.is_working== True %}selected{% endif %}>Yes</option>
            </select><br><br>

            <textarea name="description" id="description" placeholder="Description">
        {{ puzzle.description or '' if puzzle else '' }}</textarea>

        </form>
    </div>
